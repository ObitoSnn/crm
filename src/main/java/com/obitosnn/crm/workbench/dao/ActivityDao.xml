<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.obitosnn.crm.workbench.dao.ActivityDao">

    <insert id="insertActivity">
        insert into tbl_activity (

            `id`,
            `owner`,
            `name`,
            `startDate`,
            `endDate`,
            `cost`,
            `description`,
            `createTime`,
            `createBy`

        ) value (

            #{id},
            #{owner},
            #{name},
            #{startDate},
            #{endDate},
            #{cost},
            #{description},
            #{createTime},
            #{createBy}

        )
    </insert>

    <select id="getActivityList" resultType="com.obitosnn.crm.workbench.domain.Activity">

        select

        a.`id`,
        a.`name`,
        u.`name` as owner,
        a.`startDate`,
        a.`endDate`

        from tbl_activity a
        inner join tbl_user u
        on a.`owner` = u.`id`

        <where>
            
            <if test="name != null and name != ''">
                a.`name` = #{name}
            </if>
            
            <if test="owner != null and owner != ''">
                a.`owner` = u.`id`
            </if>

            <if test="startDate != null and startDate != ''">
                a.`startDate` &gt; #{startDate}
            </if>

            <if test="endDate != null and endDate != ''">
                a.`endDate` &lt; #{endDate}
            </if>

        </where>

        order by a.`createTime` desc

    </select>

    <select id="getActivityTotal" resultType="long">

        select count(*) from tbl_activity

    </select>

</mapper>